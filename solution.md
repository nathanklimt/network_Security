# Web Security
### By Nathan Klimt

## Web Authentication
The security policy of hackme needs work. First off, messages are able to be manipulated by non-users. To fix this, I used if statements to check if a user was logged in. Passwords are easily obtainable as hackme uses cookies as their password management system. You should never store sensitive information in cookies as they can be available as plain text. This is a huge problem when it comes to confidentiality as passwords can be easily cracked. In order to fix this, I used sessions to manage the passwords as it only uses one cookie per user. I also used sha1 to hash the passwords. It is possible to snoop on hackme, but I was not able to figure out a way to prevent this. There were no measures taken against a brute-force attack. In order to fix this, I only allow a user to attempt to login five times. There are no parameters set for the user password, which is a problem, as hackme allows for a one character password, which obviously isn't secure. In order to fix this, I forced the user to create a password of at least eight characters. In order to ensure that users do not create a password from a dictionary word, I used the pspell_check function to search the dictionary when a user enters a password while registering.

## CSRF Attack and Remediation
Before changing any code, an attacker was able to log into a victims account without them knowing through a CSRF attack. All that it takes for a CSRF attack to happen is for a user to be fooled by a malicious webpage or popup. If they were to click on the webpage, a CSRF attack could occur and all of their credentials would be sent to the attacker. From there, the attacker would be able to log into their account, using the victim's credentials. In order to complete a successful CSRF attack, I had to draw them into my webpage. After doing this, I ran a program that manipulated the session cookies on the page, which stored the user's credentials. By doing this, I was able to successfully login to their hackme as I now had their username and password. To fix this, I used tokens that would be tied to the user's session. I then used an if statement to detect any potential threats, which then redirected the attacker to a blank page, stating that a CSRF attack had been detected. By adding things to the site that were only accessible through the site, it prevented atackers from trying to trick users into doing things without their knowledge. 

## XSS Attack and Remediation
Before implementing any fixes to the hackme webpage, an attacker was able to lure a victim in using the database and be able to run a program on their system, essentially running an XSS attack. To implement my own attack, I posted a message in the database which then lured the victim in. A script such as "<img src="http://testing.com/book.html?default=<script>alert(document.cookie)</script>" />" would be put in the database, which would then be able to execute javascript on the victims account. The javacript then manipulated the victim's personal information and returned it back to me. Through doing this, I was able to get information on the victims cookies. From there, the cookies were able to get me the victims username and password. To fix this, I sanitized, which removed all scripts or input files before they get added to the database. Doing this ensured that the database would be clean and free of any malicious scripts or files. I then stripped all tags from user input fields before inserting them into the database to prevent unauthorized scripts from running on the site. By doing all of this, I ensured that an attacker would not be able to run any scripts in the background that would infect hackme. 

## SQL Injection Attack and Remediation
Before changing any code to hackme, an attacker was able to manipulate the hackme database relatively easily through running commands on either the POST or GET. All that I had to do to implement an attack was run certain commands through the GET, similar to our SQL injection lab. By hovering over the hackme text given by the index.php page, I was given a specific URL. From there, I simply put the URL in my browser, added a few commands, such as "OR '1'='1" and "INSERT into USERS(username, pass, fname, lname) VALUES ('nklimt', 'Nathan', 'Klimt')". By running these commands, I was able to manipulate the database and change the current posts. I was also able to run commands in the GET using 'INSERT' and 'DELETE', which deleted or created posts or users within hackme, whichever I chose. In order to fix this, I had to use prepare statements to prepare the query so the database knew exactly how many parameters it should expect. It also helps them safely escape, preventing any malicious attempts. Doing this prepared any SQL command in my program for a potential SQL injection attack. 




